
@model TextQuest.Models.SceneListModel

<head runat="server">
    <link rel="stylesheet" type="text/css" href="~/css/site.css" runat="server">
    <link href="https://fonts.googleapis.com/css?family=Oswald|Share+Tech+Mono|Montserrat" rel="stylesheet">
</head>
<body>
    <div class="back-container">
        <div class="allgame">
            <div id="countholder">
                <div id="countdown">
                    <p><span id="remain"></span></p>
                </div>
            </div>
            @Html.Partial("_GetSceneObjects", Model)
        </div>
    </div>

    <script>
        // Display countdown
        var date0 = new Date();
        var timeout = date0.getTime() + @Model.RemainingTime*1000; //+remainingtime *1000
        function updateCountdown() {
            // Calculate time
            var date = new Date();
            var time = Math.ceil((timeout - date.getTime() - 50) / 1000);  // remaining time in seconds
            // Display time
            var out = document.getElementById("remain");
            if (!out) {
                return;
            }
            while (out.lastChild) {
                out.removeChild(out.lastChild);
            }
            var minutes = String(Math.floor(time / 60));
            var seconds = String(time - 60 * minutes);
            if (seconds.length < 2) seconds = "0" + seconds;
            var display = minutes + ":" + seconds;
            var displayNode = document.createTextNode(display);
            out.appendChild(displayNode);
            out.setAttribute("data-remaining", time);
        }
        // Initialize forwarding

            // Additional timer to update the countdown
        window.onload = function () {
            updateCountdown();
            if (@Model.CurrentScene.Id != 1022 && @Model.CurrentScene.Id != 1023 && @Model.CurrentScene.Id != 1024 && @Model.CurrentScene.Id != 1025) {
                window.setInterval(updateCountdown, 1000);
                window.setTimeout(next,  @Model.RemainingTime* 1000);
            }
            else {
                window.clearInterval();
                window.clearTimeout();
            }
                
            }
      //  });
        function next() {
            // Display message (optional)
            window.location.replace(1022);

            // TODO:bad Ending cutscene
        }
    </script>>


</body>

